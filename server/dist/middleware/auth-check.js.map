{"version":3,"sources":["../../src/middleware/auth-check.js"],"names":["module","exports","req","res","next","headers","authorization","status","end","token","user","console","info","log","err"],"mappings":";;AAAA;;;;AAEA;;;AAGAA,OAAOC,OAAP,GAAiB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACnC;AACA,SAAO,wDAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBACDF,IAAIG,OAAJ,CAAYC,aADX;AAAA;AAAA;AAAA;;AAAA,6CAEGH,IAAII,MAAJ,CAAW,GAAX,EAAgBC,GAAhB,EAFH;;AAAA;AAAA;AAMEC,iBANF,GAMU,2BAAeP,GAAf,CANV;AAAA;AAAA,mBAOe,iCAAqBO,KAArB,CAPf;;AAAA;AAOEC,gBAPF;;AAAA,gBASCA,IATD;AAAA;AAAA;AAAA;;AAAA,6CAUKP,IAAII,MAAJ,CAAW,GAAX,EAAgBC,GAAhB,EAVL;;AAAA;AAYJG,oBAAQC,IAAR,CAAa,OAAb,EAAsBF,IAAtB;;AAZI,6CAcGN,MAdH;;AAAA;AAAA;AAAA;;AAgBJO,oBAAQE,GAAR,CAAY,aAAZ,EAA2BC,GAA3B;AAhBI,6CAiBGX,IAAII,MAAJ,CAAW,GAAX,EAAgBC,GAAhB,EAjBH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,IAAP;AAoBD,CAtBD","file":"auth-check.js","sourcesContent":["import { verifyAuthentication, getHeaderToken } from '../utils'\n\n/**\n *  The Auth Checker middleware function.\n */\nmodule.exports = (req, res, next) => {\n  // get the last part from a authorization header string like \"bearer token-value\"\n  return (async () => {\n    if (!req.headers.authorization) {\n      return res.status(401).end()\n    }\n\n    try {\n      const token = getHeaderToken(req)\n      const user = await verifyAuthentication(token)\n\n      if (!user) {\n        return res.status(401).end()\n      }\n      console.info('USSER', user)\n\n      return next()\n    } catch (error) {\n      console.log('ERRO GRAVE:', err)\n      return res.status(401).end()\n    }\n  })()\n}\n"]}