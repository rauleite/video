{"version":3,"sources":["../../src/models/captcha.js"],"names":["CaptchaSchema","Schema","email","type","String","index","unique","hasCaptchaComponent","Boolean","default","count","Number","countExpires","Date","pre","next","console","log","module","exports","model"],"mappings":";;AAAA;;;;;;AAEA;AACA,IAAMA,gBAAgB,IAAI,mBAASC,MAAb,CAAoB;AACxCC,SAAO;AACLC,UAAMC,MADD;AAELC,WAAO,EAAEC,QAAQ,IAAV;AAFF,GADiC;AAKxCC,uBAAqB;AACnBJ,UAAMK,OADa;AAEnBC,aAAS;AAFU,GALmB;AASxCC,SAAO;AACLP,UAAMQ,MADD;AAELF,aAAS;AAFJ,GATiC;AAaxCG,gBAAcC;AAb0B,CAApB,CAAtB;;AAgBAb,cAAcc,GAAd,CAAkB,MAAlB,EAA0B,UAAUC,IAAV,EAAgB;AACxCC,UAAQC,GAAR,CAAY,kBAAZ;AACA,SAAOF,MAAP;AACD,CAHD;;AAKAf,cAAcc,GAAd,CAAkB,MAAlB,EAA0B,UAAUC,IAAV,EAAgB;AACxCC,UAAQC,GAAR,CAAY,+BAAZ,EAA6C,KAAKP,KAAlD;;AAEA;AACA;AACA;AACA;;AAEA,MAAI,KAAKA,KAAL,IAAc,CAAlB,EAAqB;AACnB,SAAKH,mBAAL,GAA2B,IAA3B;AACD;;AAED,SAAOQ,MAAP;AACD,CAbD;;AAeAG,OAAOC,OAAP,GAAiB,mBAASC,KAAT,CAAe,SAAf,EAA0BpB,aAA1B,CAAjB","file":"captcha.js","sourcesContent":["import mongoose from 'mongoose'\n\n// define the User model schema\nconst CaptchaSchema = new mongoose.Schema({\n  email: {\n    type: String,\n    index: { unique: true }\n  },\n  hasCaptchaComponent: {\n    type: Boolean,\n    default: false\n  },\n  count: {\n    type: Number,\n    default: 0\n  },\n  countExpires: Date\n})\n\nCaptchaSchema.pre('save', function (next) {\n  console.log('[model] pre save')\n  return next()\n})\n\nCaptchaSchema.pre('save', function (next) {\n  console.log('[model] pre save - this.count', this.count)\n\n  // if (this.hasFormError) {\n  //   console.log('[model] this.count', this.count)\n  //   this.count = this.count + 1\n  // }\n\n  if (this.count >= 2) {\n    this.hasCaptchaComponent = true\n  }\n\n  return next()\n})\n\nmodule.exports = mongoose.model('Captcha', CaptchaSchema)\n"]}